<div class="container mx-auto p-6 max-w-2xl">
  <h2 class="text-2xl font-bold mb-6">Edit Student</h2>

  <!-- Loading Spinner -->
  <div *ngIf="isLoading" class="flex justify-center items-center my-4">
    <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4" role="alert">
    <p>{{ errorMessage }}</p>
  </div>

  <form [formGroup]="studentForm" (ngSubmit)="saveStudent()" class="space-y-6">
    <!-- First Name -->
    <div class="form-group">
      <label for="firstName" class="block text-sm font-medium text-gray-700 mb-1">
        First Name <span class="text-red-500">*</span>
      </label>
      <input 
        id="firstName" 
        formControlName="firstName" 
        type="text"
        class="w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
        [ngClass]="{'border-red-500': isFieldInvalid('firstName')}"
        aria-describedby="firstName-error"
      />
      <div *ngIf="isFieldInvalid('firstName')" 
           id="firstName-error" 
           class="mt-1 text-sm text-red-600" 
           role="alert">
        <span *ngIf="studentForm.get('firstName')?.errors?.['required']">First name is required.</span>
        <span *ngIf="studentForm.get('firstName')?.errors?.['minlength']">First name must be at least 2 characters.</span>
      </div>
    </div>

    <!-- Last Name -->
    <div class="form-group">
      <label for="lastName" class="block text-sm font-medium text-gray-700 mb-1">
        Last Name <span class="text-red-500">*</span>
      </label>
      <input 
        id="lastName" 
        formControlName="lastName" 
        type="text"
        class="w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
        [ngClass]="{'border-red-500': isFieldInvalid('lastName')}"
        aria-describedby="lastName-error"
      />
      <div *ngIf="isFieldInvalid('lastName')" 
           id="lastName-error" 
           class="mt-1 text-sm text-red-600" 
           role="alert">
        <span *ngIf="studentForm.get('lastName')?.errors?.['required']">Last name is required.</span>
        <span *ngIf="studentForm.get('lastName')?.errors?.['minlength']">Last name must be at least 2 characters.</span>
      </div>
    </div>

    <!-- Email -->
    <div class="form-group">
      <label for="email" class="block text-sm font-medium text-gray-700 mb-1">
        Email <span class="text-red-500">*</span>
      </label>
      <input 
        id="email" 
        formControlName="email" 
        type="email"
        class="w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
        [ngClass]="{'border-red-500': isFieldInvalid('email')}"
        aria-describedby="email-error"
      />
      <div *ngIf="isFieldInvalid('email')" 
           id="email-error" 
           class="mt-1 text-sm text-red-600" 
           role="alert">
        <span *ngIf="studentForm.get('email')?.errors?.['required']">Email is required.</span>
        <span *ngIf="studentForm.get('email')?.errors?.['email']">Please enter a valid email address.</span>
      </div>
    </div>

    <!-- Degree -->
    <div class="form-group">
      <label for="degree" class="block text-sm font-medium text-gray-700 mb-1">
        Degree <span class="text-red-500">*</span>
      </label>
      <input 
        id="degree" 
        formControlName="degree" 
        type="text"
        class="w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
        [ngClass]="{'border-red-500': isFieldInvalid('degree')}"
        aria-describedby="degree-error"
      />
      <div *ngIf="isFieldInvalid('degree')" 
           id="degree-error" 
           class="mt-1 text-sm text-red-600" 
           role="alert">
        <span *ngIf="studentForm.get('degree')?.errors?.['required']">Degree is required.</span>
        <span *ngIf="studentForm.get('degree')?.errors?.['minlength']">Degree must be at least 2 characters.</span>
      </div>
    </div>

    <!-- Year -->
    <div class="form-group">
      <label for="year" class="block text-sm font-medium text-gray-700 mb-1">
        Year <span class="text-red-500">*</span>
      </label>
      <input 
        id="year" 
        formControlName="year" 
        type="number"
        min="1"
        max="4"
        class="w-full px-3 py-2 border rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500"
        [ngClass]="{'border-red-500': isFieldInvalid('year')}"
        aria-describedby="year-error"
      />
      <div *ngIf="isFieldInvalid('year')" 
           id="year-error" 
           class="mt-1 text-sm text-red-600" 
           role="alert">
        <span *ngIf="studentForm.get('year')?.errors?.['required']">Year is required.</span>
        <span *ngIf="studentForm.get('year')?.errors?.['min'] || studentForm.get('year')?.errors?.['max']">
          Year must be between 1 and 4.
        </span>
      </div>
    </div>

    <!-- Form Actions -->
    <div class="flex space-x-4 pt-4">
      <button 
        type="submit" 
        [disabled]="studentForm.invalid || isLoading"
        class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed">
        {{ isLoading ? 'Saving...' : 'Save' }}
      </button>
      <button 
        type="button" 
        (click)="router.navigate(['/students'])"
        class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2">
        Cancel
      </button>
    </div>
  </form>
</div>
  