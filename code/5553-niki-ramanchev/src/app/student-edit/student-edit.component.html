<div *ngIf="student; else errorTemplate">
  <h2>Edit Student</h2>

  <form (ngSubmit)="saveStudent()">
    <h3>Personal Information</h3>
    <label>
      First Name:
      <input type="text" [(ngModel)]="student.firstName" name="firstName" required />
    </label>
    <label>
      Last Name:
      <input type="text" [(ngModel)]="student.lastName" name="lastName" required />
    </label>
    <label>
      Email:
      <input type="email" [(ngModel)]="student.email" name="email" required />
    </label>
    <label>
      Degree:
      <select [(ngModel)]="student.degree" name="degree" required>
        <option *ngFor="let degree of degrees" [value]="degree">{{ degree }}</option>
      </select>
    </label>
    <label>
      Year:
      <input type="number" [(ngModel)]="student.year" name="year" min="1" max="4" required />
    </label>

    <h3>Course Management</h3>
    <table>
      <thead>
        <tr>
          <th>Course Code</th>
          <th>Semester</th>
          <th>Grade</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let course of student.courses">
          <td>{{ course.code }}</td>
          <td>{{ course.semester }}</td>
          <td>
            <input
              *ngIf="!course.grade"
              type="number"
              [(ngModel)]="courseGrades[course.code].percentage"
              placeholder="Grade %"
              name="grade-{{ course.code }}"
              min="0"
              max="100"
            />
            <span *ngIf="course.grade">
              {{ course.grade.percentage }} ({{ course.grade.letter }})
            </span>
          </td>
          <td>
            <button *ngIf="!course.grade" type="button" (click)="addGrade(course.code)">
              Add Grade
            </button>
          </td>
        </tr>
      </tbody>
    </table>

    <div class="actions">
      <button type="submit">Save</button>
      <button type="button" (click)="cancel()">Cancel</button>
    </div>
  </form>
</div>

<ng-template #errorTemplate>
  <p>{{ errorMessage }}</p>
</ng-template>
